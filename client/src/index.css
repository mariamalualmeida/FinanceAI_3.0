@tailwind base;
@tailwind components;
@tailwind utilities;

/* Mobile-first optimizations */
@layer base {
  * {
    @apply border-border;
    box-sizing: border-box;
  }
  
  body {
    @apply bg-background text-foreground font-sans antialiased;
    font-feature-settings: "rlig" 1, "calt" 1;
    -webkit-font-smoothing: antialiased;
    -moz-osx-font-smoothing: grayscale;
    -webkit-tap-highlight-color: transparent;
  }

  /* Mobile viewport optimizations */
  html {
    @apply h-full;
    touch-action: manipulation;
    overflow-x: hidden;
  }

  body {
    @apply h-full;
    overscroll-behavior: none;
    overflow-x: hidden;
  }

  /* Prevent horizontal overflow globally */
  #root {
    width: 100vw;
    height: 100vh;
    overflow-x: hidden;
    max-width: 100%;
  }

  /* Better touch targets for mobile */
  button, 
  [role="button"], 
  input[type="submit"], 
  input[type="button"] {
    touch-action: manipulation;
    min-height: 44px; /* iOS accessibility guidelines */
  }

  /* Smooth scrolling for mobile */
  * {
    scroll-behavior: smooth;
    -webkit-overflow-scrolling: touch;
  }

  /* Focus styles for accessibility */
  *:focus-visible {
    @apply outline-2 outline-offset-2 outline-primary;
  }

  /* Prevent text areas from expanding beyond container */
  textarea {
    max-width: 100%;
    width: 100%;
  }
}

/* Mobile-specific component overrides */
@layer components {
  /* Sidebar mobile optimization */
  .sidebar-mobile {
    @apply fixed inset-0 z-50 bg-background;
    @apply transform transition-transform duration-300 ease-in-out;
  }

  .sidebar-mobile.open {
    @apply translate-x-0;
  }

  .sidebar-mobile.closed {
    @apply -translate-x-full;
  }

  /* Better mobile buttons */
  .btn-mobile {
    @apply min-h-[48px] px-6 py-3 text-base font-medium;
    @apply touch-manipulation;
  }

  /* Mobile-friendly inputs */
  .input-mobile {
    @apply min-h-[48px] px-4 py-3 text-base;
    @apply border-2 rounded-lg;
    @apply focus:border-primary focus:ring-0;
  }

  /* Chat interface mobile optimizations */
  .chat-container {
    @apply flex flex-col h-full;
    height: calc(100vh - 56px); /* Account for top bar */
  }

  @media (min-width: 1024px) {
    .chat-container {
      height: 100vh;
    }
  }

  /* Messages area mobile optimization */
  .messages-area {
    @apply flex-1 overflow-y-auto;
    @apply px-4 py-4;
    -webkit-overflow-scrolling: touch;
    overscroll-behavior: contain;
  }

  /* Message bubble mobile styles */
  .message-bubble {
    @apply max-w-[85%] mb-4 p-4 rounded-2xl;
    @apply break-words;
  }

  .message-bubble.user {
    @apply bg-primary text-primary-foreground ml-auto;
    @apply rounded-br-md;
  }

  .message-bubble.assistant {
    @apply bg-muted text-foreground;
    @apply rounded-bl-md;
  }

  /* Input area mobile optimization */
  .input-area {
    @apply border-t border-border bg-background;
    @apply p-4 pb-safe;
    @apply sticky bottom-0;
  }

  /* File upload mobile styles */
  .file-upload-mobile {
    @apply w-full p-6 border-2 border-dashed border-muted-foreground/25;
    @apply rounded-xl bg-muted/50;
    @apply text-center cursor-pointer;
    @apply transition-colors duration-200;
    @apply hover:border-primary/50 hover:bg-primary/5;
  }

  /* Loading states for mobile */
  .loading-spinner {
    @apply animate-spin rounded-full border-2 border-transparent;
    @apply border-t-current border-r-current;
  }

  /* Modal mobile optimization */
  .modal-mobile {
    @apply fixed inset-0 z-50 bg-black/80;
    @apply flex items-end justify-center p-0;
  }

  .modal-content-mobile {
    @apply w-full max-h-[90vh] bg-background;
    @apply rounded-t-2xl border-t border-border;
    @apply overflow-hidden;
  }

  @media (min-width: 640px) {
    .modal-mobile {
      @apply items-center p-4;
    }

    .modal-content-mobile {
      @apply w-full max-w-lg rounded-2xl border;
    }
  }
}

/* iOS Safari specific fixes */
@supports (-webkit-touch-callout: none) {
  .input-area {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  .chat-container {
    height: calc(100vh - 56px - env(safe-area-inset-bottom));
  }
}

/* Android Chrome specific fixes */
@media screen and (max-width: 768px) and (orientation: portrait) {
  .chat-container {
    height: calc(100vh - 56px);
    min-height: calc(100vh - 56px);
  }
}

/* Responsive utilities */
@layer utilities {
  .safe-top {
    padding-top: env(safe-area-inset-top);
  }

  .safe-bottom {
    padding-bottom: env(safe-area-inset-bottom);
  }

  .safe-left {
    padding-left: env(safe-area-inset-left);
  }

  .safe-right {
    padding-right: env(safe-area-inset-right);
  }

  .pb-safe {
    padding-bottom: max(1rem, env(safe-area-inset-bottom));
  }

  /* Touch-friendly sizing */
  .touch-44 {
    min-height: 44px;
    min-width: 44px;
  }

  .touch-48 {
    min-height: 48px;
    min-width: 48px;
  }

  /* Hide scrollbars but maintain functionality */
  .scrollbar-hide {
    -ms-overflow-style: none;
    scrollbar-width: none;
  }

  .scrollbar-hide::-webkit-scrollbar {
    display: none;
  }
}

:root {
  --background: hsl(0, 0%, 100%);
  --foreground: hsl(20, 14.3%, 4.1%);
  --muted: hsl(60, 4.8%, 95.9%);
  --muted-foreground: hsl(25, 5.3%, 44.7%);
  --popover: hsl(0, 0%, 100%);
  --popover-foreground: hsl(20, 14.3%, 4.1%);
  --card: hsl(0, 0%, 100%);
  --card-foreground: hsl(20, 14.3%, 4.1%);
  --border: hsl(20, 5.9%, 90%);
  --input: hsl(20, 5.9%, 90%);
  --primary: hsl(207, 90%, 54%);
  --primary-foreground: hsl(211, 100%, 99%);
  --secondary: hsl(60, 4.8%, 95.9%);
  --secondary-foreground: hsl(24, 9.8%, 10%);
  --accent: hsl(60, 4.8%, 95.9%);
  --accent-foreground: hsl(24, 9.8%, 10%);
  --destructive: hsl(0, 84.2%, 60.2%);
  --destructive-foreground: hsl(60, 9.1%, 97.8%);
  --ring: hsl(20, 14.3%, 4.1%);
  --radius: 0.5rem;
  
  /* Surface colors for Material Design */
  --surface-50: hsl(0, 0%, 98%);
  --surface-100: hsl(0, 0%, 96%);
  --surface-200: hsl(0, 0%, 93%);
  --surface-300: hsl(0, 0%, 88%);
  
  /* Success colors */
  --success-50: hsl(120, 60%, 95%);
  --success-500: hsl(142, 71%, 45%);
  --success-600: hsl(142, 71%, 40%);
}

.dark {
  --background: hsl(240, 10%, 3.9%);
  --foreground: hsl(0, 0%, 98%);
  --muted: hsl(240, 3.7%, 15.9%);
  --muted-foreground: hsl(240, 5%, 64.9%);
  --popover: hsl(240, 10%, 3.9%);
  --popover-foreground: hsl(0, 0%, 98%);
  --card: hsl(240, 10%, 3.9%);
  --card-foreground: hsl(0, 0%, 98%);
  --border: hsl(240, 3.7%, 15.9%);
  --input: hsl(240, 3.7%, 15.9%);
  --primary: hsl(207, 90%, 54%);
  --primary-foreground: hsl(211, 100%, 99%);
  --secondary: hsl(240, 3.7%, 15.9%);
  --secondary-foreground: hsl(0, 0%, 98%);
  --accent: hsl(240, 3.7%, 15.9%);
  --accent-foreground: hsl(0, 0%, 98%);
  --destructive: hsl(0, 62.8%, 30.6%);
  --destructive-foreground: hsl(0, 0%, 98%);
  --ring: hsl(240, 4.9%, 83.9%);
  
  /* Dark mode surface colors */
  --surface-50: hsl(240, 10%, 8%);
  --surface-100: hsl(240, 8%, 12%);
  --surface-200: hsl(240, 6%, 16%);
  --surface-300: hsl(240, 4%, 20%);
  
  /* Dark mode success colors */
  --success-50: hsl(120, 60%, 10%);
  --success-500: hsl(142, 71%, 45%);
  --success-600: hsl(142, 71%, 50%);
}

@layer base {
  * {
    @apply border-border;
  }

  body {
    @apply font-sans antialiased bg-background text-foreground;
    font-family: 'Roboto', system-ui, sans-serif;
  }

  h1, h2, h3, h4, h5, h6 {
    font-family: 'Inter', system-ui, sans-serif;
  }
}

@layer components {
  .chat-bubble-user {
    background: linear-gradient(135deg, hsl(207, 90%, 54%), hsl(207, 90%, 49%));
  }
  
  .chat-bubble-ai {
    background: linear-gradient(135deg, hsl(0, 0%, 97%), hsl(0, 0%, 100%));
    border: 1px solid hsl(20, 5.9%, 90%);
  }
  
  .dark .chat-bubble-ai {
    background: linear-gradient(135deg, hsl(240, 10%, 8%), hsl(240, 10%, 12%));
    border: 1px solid hsl(240, 3.7%, 15.9%);
  }
  
  .typing-indicator {
    animation: pulse 2s infinite;
  }
  
  @keyframes pulse {
    0%, 100% { opacity: 1; }
    50% { opacity: 0.5; }
  }
  
  .upload-area {
    background: linear-gradient(145deg, hsl(0, 0%, 97%), hsl(0, 0%, 100%));
    border: 2px dashed hsl(207, 90%, 54%);
    transition: all 0.3s ease;
  }
  
  .upload-area:hover {
    background: linear-gradient(145deg, hsl(207, 90%, 95%), hsl(0, 0%, 97%));
    border-color: hsl(207, 90%, 49%);
  }
  
  .dark .upload-area {
    background: linear-gradient(145deg, hsl(240, 10%, 8%), hsl(240, 10%, 12%));
    border-color: hsl(207, 90%, 54%);
  }
  
  .dark .upload-area:hover {
    background: linear-gradient(145deg, hsl(240, 10%, 12%), hsl(240, 10%, 16%));
    border-color: hsl(207, 90%, 49%);
  }
  
  .card-elevated {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }
  
  .dark .card-elevated {
    box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.3), 0 2px 4px -1px rgba(0, 0, 0, 0.2);
  }
  
  .sidebar-transition {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }
  
  .material-icon {
    font-family: 'Material Icons';
    font-weight: normal;
    font-style: normal;
    font-size: 24px;
    line-height: 1;
    letter-spacing: normal;
    text-transform: none;
    display: inline-block;
    white-space: nowrap;
    word-wrap: normal;
    direction: ltr;
    -webkit-font-feature-settings: 'liga';
    -webkit-font-smoothing: antialiased;
  }
}

@layer utilities {
  .text-surface-600 {
    color: hsl(25, 5.3%, 44.7%);
  }
  
  .bg-surface-50 {
    background-color: var(--surface-50);
  }
  
  .bg-surface-100 {
    background-color: var(--surface-100);
  }
  
  .bg-surface-200 {
    background-color: var(--surface-200);
  }
  
  .bg-surface-300 {
    background-color: var(--surface-300);
  }
  
  .border-surface-200 {
    border-color: var(--surface-200);
  }
  
  .border-surface-300 {
    border-color: var(--surface-300);
  }
  
  .text-success-500 {
    color: var(--success-500);
  }
  
  .text-success-600 {
    color: var(--success-600);
  }
  
  .bg-success-50 {
    background-color: var(--success-50);
  }
  
  .bg-success-500 {
    background-color: var(--success-500);
  }
  
  .bg-success-600 {
    background-color: var(--success-600);
  }
}
