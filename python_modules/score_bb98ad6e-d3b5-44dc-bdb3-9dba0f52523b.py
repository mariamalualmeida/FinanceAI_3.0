
import json
import pandas as pd
from datetime import datetime, timedelta

def calculate_credit_score(transactions, personal_data):
    """Calculate credit score based on transaction history and personal data."""
    
    if not transactions:
        return 300  # Minimum score for no data
    
    df = pd.DataFrame(transactions)
    
    # Base score
    score = 500
    
    # Income consistency (20% weight)
    income_transactions = [t for t in transactions if t['value'] > 0]
    if income_transactions:
        incomes = [t['value'] for t in income_transactions]
        if len(incomes) > 1:
            income_std = pd.Series(incomes).std()
            income_mean = pd.Series(incomes).mean()
            cv = income_std / income_mean if income_mean > 0 else 1
            consistency_score = max(0, 100 - (cv * 100))
            score += consistency_score
    
    # Expense control (20% weight)
    expense_transactions = [t for t in transactions if t['value'] < 0]
    if expense_transactions and income_transactions:
        total_expenses = sum(abs(t['value']) for t in expense_transactions)
        total_income = sum(t['value'] for t in income_transactions)
        expense_ratio = total_expenses / total_income if total_income > 0 else 1
        
        if expense_ratio < 0.5:
            score += 100
        elif expense_ratio < 0.7:
            score += 80
        elif expense_ratio < 0.9:
            score += 60
        elif expense_ratio < 1.0:
            score += 40
        else:
            score -= 50
    
    # Transaction frequency and variety (15% weight)
    if len(transactions) > 10:
        score += 50
    elif len(transactions) > 5:
        score += 30
    
    # Betting detection penalty (25% weight)
    betting_count = 0
    betting_amount = 0
    
    sites_apostas = ['bet365', 'betano', 'sportingbet', 'pixbet', 'blaze', 'stake', 'aposta', 'cassino']
    
    for transaction in transactions:
        desc_lower = transaction['description'].lower()
        if any(site in desc_lower for site in sites_apostas):
            betting_count += 1
            betting_amount += abs(transaction['value'])
    
    if betting_count > 0:
        total_amount = sum(abs(t['value']) for t in transactions)
        betting_ratio = betting_amount / total_amount if total_amount > 0 else 0
        
        penalty = min(200, betting_ratio * 500 + betting_count * 10)
        score -= penalty
    
    # Balance consistency (10% weight)
    values = [t['value'] for t in transactions]
    running_balance = []
    balance = 0
    
    for value in values:
        balance += value
        running_balance.append(balance)
    
    negative_balance_count = sum(1 for b in running_balance if b < 0)
    if negative_balance_count == 0:
        score += 50
    elif negative_balance_count < len(running_balance) * 0.1:
        score += 30
    
    # Recent activity (10% weight)
    recent_transactions = []
    cutoff_date = datetime.now() - timedelta(days=30)
    
    for transaction in transactions:
        try:
            if isinstance(transaction['date'], str):
                trans_date = datetime.fromisoformat(transaction['date'].replace('Z', '+00:00'))
            else:
                trans_date = transaction['date']
            
            if trans_date >= cutoff_date:
                recent_transactions.append(transaction)
        except:
            continue
    
    if len(recent_transactions) > 0:
        score += min(30, len(recent_transactions) * 3)
    
    # Ensure score is within valid range
    score = max(300, min(850, score))
    
    return int(score)

if __name__ == "__main__":
    transactions = [{"date":"2025-06-02T00:00:00","description":"Recebimento PIX","value":20,"document_number":"311639","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 311639 CRED PIX 20,00 C 20,99 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-02T00:00:00","description":"Transferência PIX","value":-16,"document_number":"311702","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 311702 ENVIO PIX 16,00 D 4,99 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-02T00:00:00","description":"Recebimento PIX","value":25,"document_number":"011805","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 011805 CRED PIX 25,00 C 29,99 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-02T00:00:00","description":"Transferência PIX","value":-22.92,"document_number":"011825","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 011825 ENVIO PIX 22,92 D 7,07 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-02T00:00:00","description":"Recebimento PIX","value":39,"document_number":"011838","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 011838 CRED PIX 39,00 C 46,07 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-02T00:00:00","description":"Transferência PIX","value":-38.48,"document_number":"011841","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 011841 ENVIO PIX 38,48 D 7,59 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-02T00:00:00","description":"Recebimento PIX","value":16,"document_number":"022025","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 022025 CRED PIX 16,00 C 23,59 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-02T00:00:00","description":"Transferência PIX","value":-12.95,"document_number":"022027","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"02/06/2025 022027 ENVIO PIX 12,95 D 10,64 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-03T00:00:00","description":"Recebimento PIX","value":105,"document_number":"031050","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"03/06/2025 031050 CRED PIX 105,00 C 115,64 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-03T00:00:00","description":"Recebimento PIX","value":35,"document_number":"031107","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"03/06/2025 031107 CRED PIX 35,00 C 150,64 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-03T00:00:00","description":"Transferência PIX","value":-19.99,"document_number":"031155","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"03/06/2025 031155 ENVIO PIX 19,99 D 130,65 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-03T00:00:00","description":"Transferência PIX","value":-26,"document_number":"031203","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"03/06/2025 031203 ENVIO PIX 26,00 D 104,65 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-03T00:00:00","description":"Transferência PIX","value":-19.59,"document_number":"032133","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"03/06/2025 032133 ENVIO PIX 19,59 D 85,06 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-04T00:00:00","description":"Transferência PIX","value":-41.79,"document_number":"041233","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"04/06/2025 041233 ENVIO PIX 41,79 D 43,27 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-04T00:00:00","description":"Recebimento PIX","value":780,"document_number":"041446","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"04/06/2025 041446 CRED PIX 780,00 C 823,27 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-04T00:00:00","description":"Transferência PIX","value":-640,"document_number":"041449","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"04/06/2025 041449 ENVIO PIX 640,00 D 183,27 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-04T00:00:00","description":"Transferência PIX","value":-135,"document_number":"041450","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"04/06/2025 041450 ENVIO PIX 135,00 D 48,27 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Recebimento PIX","value":30,"document_number":"050747","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050747 CRED PIX 30,00 C 78,27 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-12.26,"document_number":"050803","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050803 ENVIO PIX 12,26 D 66,01 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-18.97,"document_number":"050817","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050817 ENVIO PIX 18,97 D 47,04 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-40,"document_number":"050917","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050917 ENVIO PIX 40,00 D 7,04 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Recebimento PIX","value":54,"document_number":"050921","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050921 CRED PIX 54,00 C 61,04 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-10,"document_number":"050923","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 050923 ENVIO PIX 10,00 D 51,04 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-13.98,"document_number":"051000","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 051000 ENVIO PIX 13,98 D 15,56 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-05T00:00:00","description":"Recebimento PIX","value":2.52,"document_number":"052150","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 052150 CRED PIX 2,52 C 18,08 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-05T00:00:00","description":"Transferência PIX","value":-17.48,"document_number":"052151","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"05/06/2025 052151 ENVIO PIX 17,48 D 0,60 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Recebimento PIX","value":18,"document_number":"061224","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061224 CRED PIX 18,00 C 18,60 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-06T00:00:00","description":"Recebimento PIX","value":36,"document_number":"061307","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061307 CRED PIX 36,00 C 54,60 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-06T00:00:00","description":"Recebimento PIX","value":74,"document_number":"061347","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061347 CRED PIX 74,00 C 128,60 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-10.1,"document_number":"061419","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061419 ENVIO PIX 10,10 D 118,50 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Recebimento PIX","value":4000,"document_number":"061538","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061538 CRED PIX 4.000,00 C 4.118,50 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-240,"document_number":"061546","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061546 ENVIO PIX 240,00 D 3.878,50 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-54,"document_number":"061556","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061556 ENVIO PIX 54,00 D 3.824,50 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-35,"document_number":"061605","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061605 ENVIO PIX 35,00 D 3.789,50 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-9.3,"document_number":"061651","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061651 ENVIO PIX 9,30 D 3.780,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-50,"document_number":"061705","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061705 ENVIO PIX 50,00 D 3.730,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-2,"document_number":"061718","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061718 ENVIO PIX 2,00 D 3.728,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-500,"document_number":"061742","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061742 ENVIO PIX 500,00 D 3.228,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-480,"document_number":"061755","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061755 ENVIO PIX 480,00 D 2.748,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-500,"document_number":"061913","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061913 ENVIO PIX 500,00 D 2.248,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-800,"document_number":"061930","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061930 ENVIO PIX 800,00 D 1.448,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-400,"document_number":"061935","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061935 ENVIO PIX 400,00 D 1.048,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-320,"document_number":"061942","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061942 ENVIO PIX 320,00 D 728,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-300,"document_number":"061954","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 061954 ENVIO PIX 300,00 D 428,20 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Recebimento PIX","value":6026.08,"document_number":"062041","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 062041 CRED PIX 6.026,08 C 6.454,28 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-332,"document_number":"062102","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 062102 ENVIO PIX 332,00 D 6.122,28 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-7,"document_number":"062158","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 062158 ENVIO PIX 7,00 D 6.115,28 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-06T00:00:00","description":"Transferência PIX","value":-62.79,"document_number":"062210","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"06/06/2025 062210 ENVIO PIX 62,79 D 6.052,49 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-9.98,"document_number":"070309","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 070309 ENVIO PIX 9,98 D 6.042,51 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":750,"document_number":"071011","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071011 CRED PIX 750,00 C 6.792,51 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-750,"document_number":"071013","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071013 ENVIO PIX 750,00 D 6.042,51 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Compra com Cartão","value":-23.75,"document_number":"071037","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071037 COMPRA 23,75 D 6.018,76 C","category":"compras_cartao","subcategory":"compras_diversos"},{"date":"2025-06-09T00:00:00","description":"Compra com Cartão","value":-108,"document_number":"071056","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071056 COMPRA 108,00 D 5.910,76 C","category":"compras_cartao","subcategory":"compras_diversos"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-350.21,"document_number":"071143","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071143 ENVIO PIX 350,21 D 5.560,55 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-37.94,"document_number":"071146","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071146 ENVIO PIX 37,94 D 5.522,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-249.73,"document_number":"071157","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071157 ENVIO PIX 249,73 D 5.272,88 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-293,"document_number":"071247","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071247 ENVIO PIX 293,00 D 4.979,88 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-21.27,"document_number":"071253","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071253 ENVIO PIX 21,27 D 4.958,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-800,"document_number":"071300","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071300 ENVIO PIX 800,00 D 4.158,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-900,"document_number":"071311","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071311 ENVIO PIX 900,00 D 3.258,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1300,"document_number":"071315","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071315 ENVIO PIX 1.300,00 D 1.958,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1500,"document_number":"071335","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071335 ENVIO PIX 1.500,00 D 458,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":1900,"document_number":"071340","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071340 CRED PIX 1.900,00 C 2.358,61 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1900,"document_number":"071342","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071342 ENVIO PIX 1.900,00 D 458,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":2000,"document_number":"071348","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071348 CRED PIX 2.000,00 C 2.458,61 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-2000,"document_number":"071350","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071350 ENVIO PIX 2.000,00 D 458,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-400,"document_number":"071358","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071358 ENVIO PIX 400,00 D 58,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":1182,"document_number":"071416","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071416 CRED PIX 1.182,00 C 1.240,61 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1100,"document_number":"071418","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071418 ENVIO PIX 1.100,00 D 140,61 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":11041.49,"document_number":"071440","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071440 CRED PIX 11.041,49 C 11.182,10 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-5000,"document_number":"071444","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071444 ENVIO PIX 5.000,00 D 6.182,10 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-15.91,"document_number":"071812","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071812 ENVIO PIX 15,91 D 6.166,19 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-18,"document_number":"071816","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071816 ENVIO PIX 18,00 D 6.148,19 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Compra com Cartão","value":-61,"document_number":"071835","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 071835 COMPRA 61,00 D 6.087,19 C","category":"compras_cartao","subcategory":"compras_diversos"},{"date":"2025-06-09T00:00:00","description":"Compra com Cartão","value":-20,"document_number":"072034","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072034 COMPRA 20,00 D 6.067,19 C","category":"compras_cartao","subcategory":"compras_diversos"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-15.95,"document_number":"072136","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072136 ENVIO PIX 15,95 D 6.051,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-16,"document_number":"072138","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072138 ENVIO PIX 16,00 D 6.035,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-2000,"document_number":"072144","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072144 ENVIO PIX 2.000,00 D 4.035,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-2000,"document_number":"072148","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072148 ENVIO PIX 2.000,00 D 2.035,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1500,"document_number":"072152","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072152 ENVIO PIX 1.500,00 D 535,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":2000,"document_number":"072203","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072203 CRED PIX 2.000,00 C 2.535,24 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-2000,"document_number":"072204","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072204 ENVIO PIX 2.000,00 D 535,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":1500,"document_number":"072228","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072228 CRED PIX 1.500,00 C 2.035,24 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1500,"document_number":"072229","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072229 ENVIO PIX 1.500,00 D 535,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":1500,"document_number":"072244","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072244 CRED PIX 1.500,00 C 2.035,24 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-1500,"document_number":"072246","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072246 ENVIO PIX 1.500,00 D 535,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-400,"document_number":"072309","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 072309 ENVIO PIX 400,00 D 135,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-130,"document_number":"080000","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 080000 ENVIO PIX 130,00 D 5,24 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":88,"document_number":"081238","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 081238 CRED PIX 88,00 C 93,24 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-13.94,"document_number":"081243","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 081243 ENVIO PIX 13,94 D 79,30 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-70,"document_number":"081252","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 081252 ENVIO PIX 70,00 D 9,30 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":320,"document_number":"081649","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 081649 CRED PIX 320,00 C 329,30 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-320,"document_number":"081652","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 081652 ENVIO PIX 320,00 D 9,30 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Recebimento PIX","value":800,"document_number":"091611","transaction_type":"credit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 091611 CRED PIX 800,00 C 809,30 C","category":"receitas_pix","subcategory":"transferencias_recebidas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-400,"document_number":"091614","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 091614 ENVIO PIX 400,00 D 409,30 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-400,"document_number":"091624","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 091624 ENVIO PIX 400,00 D 9,30 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-09T00:00:00","description":"Transferência PIX","value":-4.13,"document_number":"092233","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"09/06/2025 092233 ENVIO PIX 4,13 D 5,17 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"},{"date":"2025-06-10T00:00:00","description":"Transferência PIX","value":-3.99,"document_number":"100705","transaction_type":"debit","bank":"Caixa Econômica Federal","account":"02475 | 1288 | 000757299314-2","raw_line":"10/06/2025 100705 ENVIO PIX 3,99 D 1,18 C","category":"transferencias_pix","subcategory":"transferencias_enviadas"}]
    personal_data = undefined
    
    credit_score = calculate_credit_score(transactions, personal_data)
    
    result = {
        'credit_score': credit_score,
        'success': True
    }
    
    print(json.dumps(result))
